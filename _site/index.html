<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="Cache-Control" content="no-store" />
    <title>HiCView</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <script src="/js/jquery-2.1.3.min.js"></script>
    <script src="/js/bootstrap.min.js"></script>
    <script src="/js/d3.v3.min.js"></script>
    <script src="/js/jquery.mousewheel.min.js"></script>
    <script src="/js/jquery.panzoom.min.js"></script>
    <link href="/css/bootstrap.min.css" rel="stylesheet">
    <link href="/css/style.css" rel="stylesheet">
</head>

<body>


<div class="container-fluid">
    <div class="row-fluid">
        <div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                  <span class="sr-only">Toggle navigation</span>
                  <span class="icon-bar"></span>
                  <span class="icon-bar"></span>
                  <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="/">HiCView</a>
            </div>
            <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
                <ul class="nav navbar-nav">
<!--                     <li class="active"><a href="/">Home</a></li>
                    <li class="active visible-xs-block"><a href="/links.html">Links</a></li>
                    <li class="active"><a href="/archive.html">Archive</a></li> -->
                    <li class="active"><a href="/about.html">About</a></li>
                    <li class="active"> <a href="javascript:loadExample();">Example</a></li>
                    
                      <li class="active"><a href="https://github.com/nezar-compbio/hicview">Github</a></li>
                    
                </ul>
            </div>
            <a id="github-ribbon" href="https://github.com/nezar-compbio/hicview"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://camo.githubusercontent.com/365986a132ccd6a44c23a9169022c0b5c890c387/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f7265645f6161303030302e706e67" alt="Fork me on GitHub" data-canonical-src="https://s3.amazonaws.com/github/ribbons/forkme_right_red_aa0000.png"></a>
        </div>
    </div>
</div>


<div class="container container-left">
    <div class="row">
        <div class="col-md-3 hidden-xs">
            <div class="sidebar well">
Web-based viewer for High-Resolution Chromatin Conformation Capture heatmaps
</div>

<!-- <div class="sidebar well">
    <h1>Recent Posts</h1>
    
</div> -->

<div class="sidebar well">
<ul>
  <li>mirnylab</li>
  <li>compbiolab</li>
</ul>
</div>
        </div>
        <div class="col-md-9">
            <div class="article">
    <div class="well">
        <div class="content">
            <h1>View Hi-C data in your browser!</h1>

            <input type="file" id="fileloader" name="file"/>

            <div class="hic-window">
              <div class="panzoom-container">
                  <div class="panzoom">
                    <img id="heatmap" class="pixelated rotated" width="700" height="700">
                  </div>
              </div>
            </div>
            <div class="buttons">
              <button class="zoom-in">Zoom In</button>
              <button class="zoom-out">Zoom Out</button>
              <input type="range" class="zoom-range">
              <button class="reset">Reset</button>
            </div>

        </div>
    </div>

    
</div>


<script src="js/numpyloader.js"></script>
<script src="js/hicview.js"></script>
<script>
  var canvas = document.createElement("canvas");

  function onLoadMatrix(matrix) {
    var data = matrix.data,
        lenX = matrix.shape[0],
        lenY = matrix.shape[1];
    // paint the matrix onto the canvas context
    paintMatrix(canvas, lenX, lenY, data, color)

    // encode the canvas context and embed it in img tag
    $heatmap = $('#heatmap');
    $heatmap.attr("src", canvas.toDataURL("image/png"));

    // resize the bounding window
    var side = $heatmap.attr("width");
    var offset = side/Math.sqrt(2) - side/2.0;
    $hicWindow = $('.hic-window');
    $hicWindow.css("width", side*Math.sqrt(2));
    $hicWindow.css("height", side/Math.sqrt(2));
    $hicWindow.css("visibility", "visible");

    // apply panzoom
    (function() {
      var $section = $('section').first();
      $section.find('.panzoom').panzoom({
        $zoomIn: $section.find(".zoom-in"),
        $zoomOut: $section.find(".zoom-out"),
        $zoomRange: $section.find(".zoom-range"),
        $reset: $section.find(".reset"),
        // more options here
        maxScale: 10,
        startTransform: 'translate(145px, -350px)'
      });
    })();
  };

  // File Select button
  function handleFileSelect(evt) {
    var file = evt.target.files[0];
    var reader = new FileReader();
    reader.onload = function() {
      // read file contents as array buffer
      var buf = reader.result;
      var matrix = parseNumpyFileBuffer(buf);
      onLoadMatrix(matrix);
    };
    reader.readAsArrayBuffer(file);
  };
  document.getElementById('fileloader')
      .addEventListener('change', handleFileSelect, false);

  // Load Example button
  function loadExample(){
    ajaxLoadNumpyArray('data/chr22.npy', onLoadMatrix);
  };
</script>
        </div>
    </div>
</div>

<div class="container-fluid">
    <div class="row-fluid">
        <div class="span12 footer navbar-inverse navbar-fixed-bottom">
            <p class="copyright">&copy;2014-2015 HiCView.
        </div>
    </div>
</div>

</body>
</html>